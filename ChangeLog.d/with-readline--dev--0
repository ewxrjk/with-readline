# do not edit -- automatically generated by arch changelog
# arch-tag: automatic-ChangeLog--rjk@greenend.org.uk--2004/with-readline--dev--0
#

2005-03-13 17:52:26 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-14

    Summary:
      don't add blank lines to history
    Revision:
      with-readline--dev--0--patch-14

    * with-readline.c: don't add blank lines to history
    * util.c: xrealloc() is error-checking unambiguous realloc() wrapper

    modified files:
     ChangeLog.d/with-readline--dev--0 util.c with-readline.c
     with-readline.h


2005-03-13 17:42:53 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-13

    Summary:
      cope with window size changes
    Revision:
      with-readline--dev--0--patch-13

    * with-readline.c: propagate window size changes to the command.  Uses
      new signal pipe infrastructure to pick up SIGWINCH.

    modified files:
     ChangeLog.d/with-readline--dev--0 with-readline.c


2005-03-13 17:20:02 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-12

    Summary:
      application-supplied prompts
    Revision:
      with-readline--dev--0--patch-12

    * with-readline.c: support for application-supplied prompts.  This is
      quite fiddly.
    
      We implement it by monitoring the command's output and treating the
      latest incomplete line as the prompt.  Thus the command's output is
      filtered entirely through with-readline.  We turn of echoing on the
      terminal so that we don't get user input echoed back to them twice
      (Readline having already printed it as they typed it).
    
      So that Readline always knows what the prompt is, we only install the
      callback when we have some user input.  The assumption is that the user
      only starts typing when they see the prompt.  This may not be true but
      they were going to get a mess then anyway so it is relatively academic.
    
      We prep the terminal at the start and inhibit Readline from prepping or
      deprepping it itself.

    modified files:
     ChangeLog.d/with-readline--dev--0 README with-readline.c


2005-03-13 15:23:26 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-11

    Summary:
      working again on darwin
    Revision:
      with-readline--dev--0--patch-11

    * configure.ac: Don't seek -lcurses on Darwin as it screws up linking.
                    Correct pty acquisition method logic for BSD

    modified files:
     ChangeLog.d/with-readline--dev--0 configure.ac


2005-03-13 15:07:46 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-10

    Summary:
      HPUX support
    Revision:
      with-readline--dev--0--patch-10

    Amazingly not everyone has strsignal() yet.
    
    * strsignal.c: borrowed from gcc libiberty
    * configure.ac: replace strsignal() if missing
    * pty-unix98.c: correct check for I_PUSH
    * with-readline.h: declare strsignal() if missing

    new files:
     strsignal.c

    modified files:
     ChangeLog.d/with-readline--dev--0 configure.ac pty-unix98.c
     with-readline.h


2005-03-13 14:24:46 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-9

    Summary:
      AIX support
    Revision:
      with-readline--dev--0--patch-9

    * configure.ac: Move check for libcurses to the right place
                    AIX doesn't like I_PUSH calls either.
                    Determine PTMX_PATH here (AIX has to be different).

    modified files:
     ChangeLog.d/with-readline--dev--0 configure.ac with-readline.h


2005-03-13 14:05:08 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-8

    Summary:
      STREAMS support.
    Revision:
      with-readline--dev--0--patch-8

    * configure.ac: Check for libcurses and <stropts.h>
                    Suppress STREAMS ioctls on Linux
    * pty-unix98.c: Push STREAMS modules onto slave pty.  We pass the slave
                    FD back to the caller now, although it currently doesn't
                    do much with it.
    * pty-bsd.c: Pass back slave pty file descriptor.
    * with-readline.c: Typo fix plus changes to support the above.
    * with-readline.h: Include <stropts.h>.

    modified files:
     ChangeLog.d/with-readline--dev--0 configure.ac pty-bsd.c
     pty-unix98.c with-readline.c with-readline.h


2005-03-13 12:24:49 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-7

    Summary:
      documentation
    Revision:
      with-readline--dev--0--patch-7

    * with-readline.1: document options and exit status
    * README: describe with-readline, sketch installation instructions

    new files:
     README

    modified files:
     ChangeLog.d/with-readline--dev--0 Makefile.am with-readline.1
     with-readline.c


2005-03-13 12:04:41 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-6

    Summary:
      set-id fixes
    Revision:
      with-readline--dev--0--patch-6

    * with-readline.c: Remember to surrender set-id even when not making a pty
                       Move terminal settings pickup to after surrender

    modified files:
     ChangeLog.d/with-readline--dev--0 with-readline.c


2005-03-12 18:55:17 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-5

    Summary:
      more hassle-free BSD support
    Revision:
      with-readline--dev--0--patch-5

    * configure.ac: choose pty acquisition method here rather than
      with-readline.h.  Also decide whether to make the executable setuid.
    * with-readline.h: no longer decide pty acquisition here.
    * Makefile.am: make installed executable setuid on BSD.

    modified files:
     ChangeLog.d/with-readline--dev--0 Makefile.am configure.ac
     with-readline.h


2005-03-12 18:36:33 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-4

    Summary:
      insist that BSD ptys be opened safely
    Revision:
      with-readline--dev--0--patch-4

    * pty-bsd.c: abort if we do not have euid root.  Insanely, openpty()
      ignores chown/chmod failing.

    modified files:
     ChangeLog.d/with-readline--dev--0 pty-bsd.c


2005-03-12 18:25:07 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-3

    Summary:
      BSD pty fixes
    Revision:
      with-readline--dev--0--patch-3

    * with-readline.c: surrender setuid/setgid privilege, for platforms where
      you need to be setuid (or setgid) to safely acquire a pty.  Annoyingly
      you can still unsafely acquire a pty without error on such platforms.

    modified files:
     ChangeLog.d/with-readline--dev--0 with-readline.c


2005-03-12 17:50:41 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-2

    Summary:
      fixes and FreeBSD support
    Revision:
      with-readline--dev--0--patch-2

    * Makefile.am: distribute man page; include getopt*
    * with-readline.h: move readline includes to the end since they break on
      FreeBSD otherwise.

    modified files:
     ChangeLog.d/with-readline--dev--0 Makefile.am with-readline.h


2005-03-12 17:41:30 GMT	Richard Kettlewell <rjk@greenend.org.uk>	patch-1

    Summary:
      darwin port
    Revision:
      with-readline--dev--0--patch-1

    Now works on Apple Darwin.
    
    * scripts/prepare: Only create config.aux if not exists.
    * configure.ac: Get check for -lutil right way round.
    * with-readline.c: Finish up when we get EOF on pty master
                       Guarantee that pty slave is open before proceeding to
                       event loop.

    modified files:
     ChangeLog.d/with-readline--dev--0 configure.ac scripts/prepare
     with-readline.c


2005-03-12 13:36:08 GMT	Richard Kettlewell <rjk@greenend.org.uk>	base-0

    Summary:
      initial import
    Revision:
      with-readline--dev--0--base-0

    Works on Linux.

    new files:
     ChangeLog.d/with-readline--dev--0 Makefile.am acinclude.m4
     configure.ac pty-bsd.c pty-unix98.c scripts/prepare util.c
     with-readline.1 with-readline.c with-readline.h


